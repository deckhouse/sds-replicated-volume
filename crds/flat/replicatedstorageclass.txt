apiVersion=apiextensions.k8s.io/v1
kind=CustomResourceDefinition
metadata.labels.backup.deckhouse.io/cluster-config=true
metadata.labels.heritage=deckhouse
metadata.labels.module=sds-replicated-volume
metadata.name=replicatedstorageclasses.storage.deckhouse.io
spec.group=storage.deckhouse.io
spec.names.kind=ReplicatedStorageClass
spec.names.plural=replicatedstorageclasses
spec.names.shortNames[0]=rsc
spec.names.singular=replicatedstorageclass
spec.preserveUnknownFields=false
spec.scope=Cluster
spec.versions[0].additionalPrinterColumns[0].jsonPath=.status.phase
spec.versions[0].additionalPrinterColumns[0].name=Phase
spec.versions[0].additionalPrinterColumns[0].type=string
spec.versions[0].additionalPrinterColumns[1].jsonPath=.status.reason
spec.versions[0].additionalPrinterColumns[1].name=Reason
spec.versions[0].additionalPrinterColumns[1].priority=1
spec.versions[0].additionalPrinterColumns[1].type=string
spec.versions[0].additionalPrinterColumns[2].description=The age of this resource
spec.versions[0].additionalPrinterColumns[2].jsonPath=.metadata.creationTimestamp
spec.versions[0].additionalPrinterColumns[2].name=Age
spec.versions[0].additionalPrinterColumns[2].type=date
spec.versions[0].name=v1alpha1
spec.versions[0].schema.openAPIV3Schema.description=ReplicatedStorageClass is a Kubernetes Custom Resource that defines a configuration for a Kubernetes Storage class.

spec.versions[0].schema.openAPIV3Schema.properties.spec.description=Defines a Kubernetes Storage class configuration.

> Note that this field is in read-only mode.

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.reclaimPolicy.description=The storage class's reclaim policy. Might be:
- Delete (If the Persistent Volume Claim is deleted, deletes the Persistent Volume and its associated storage as well)
- Retain (If the Persistent Volume Claim is deleted, remains the Persistent Volume and its associated storage)

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.reclaimPolicy.enum[0]=Delete
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.reclaimPolicy.enum[1]=Retain
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.reclaimPolicy.type=string
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.reclaimPolicy.x-kubernetes-validations[0].message=Value is immutable.
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.reclaimPolicy.x-kubernetes-validations[0].rule=self == oldSelf
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.default=ConsistencyAndAvailability
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.description=The Storage class's replication mode. Might be:
- None — In this mode the Storage class's 'placementCount' and 'AutoEvictMinReplicaCount' params equal '1'.
- Availability — In this mode the volume remains readable and writable even if one of the replica nodes becomes unavailable. Data is stored in two copies on different nodes. This corresponds to `placementCount = 2` and `AutoEvictMinReplicaCount = 2`. **Important:** this mode does not guarantee data consistency and may lead to split brain and data loss in case of network connectivity issues between nodes. Recommended only for non-critical data and applications that do not require high reliability and data integrity.
- ConsistencyAndAvailability — In this mode the volume remains readable and writable when one replica node fails. Data is stored in three copies on different nodes (`placementCount = 3`, `AutoEvictMinReplicaCount = 3`). This mode provides protection against data loss when two nodes containing volume replicas fail and guarantees data consistency. However, if two replicas are lost, the volume switches to suspend-io mode.

> Note that default Replication mode is 'ConsistencyAndAvailability'.

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.enum[0]=None
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.enum[1]=Availability
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.enum[2]=ConsistencyAndAvailability
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.type=string
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.x-kubernetes-validations[0].message=Value is immutable.
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.replication.x-kubernetes-validations[0].rule=self == oldSelf
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.storagePool.description=Selected ReplicatedStoragePool resource's name.

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.storagePool.type=string
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.storagePool.x-kubernetes-validations[0].message=Value is immutable.
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.storagePool.x-kubernetes-validations[0].rule=self == oldSelf
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.description=The topology settings for the volumes in the created Storage class. Might be:
- TransZonal - replicas of the volumes will be created in different zones (one replica per zone). 
To use this topology, the available zones must be specified in the 'zones' param, and the cluster nodes must have the topology.kubernetes.io/zone=<zone name> label.
- Zonal - all replicas of the volumes are created in the same zone that the scheduler selected to place the pod using this volume.
- Ignored - the topology information will not be used to place replicas of the volumes.
The replicas can be placed on any available nodes, with the restriction: no more than one replica of a given volume on one node.

> Note that the 'Ignored' value can be used only if there are no zones in the cluster (there are no nodes with the topology.kubernetes.io/zone label).

> For the system to operate correctly, either every cluster node must be labeled with 'topology.kubernetes.io/zone', or none of them should have this label.

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.enum[0]=TransZonal
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.enum[1]=Zonal
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.enum[2]=Ignored
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.type=string
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.x-kubernetes-validations[0].message=Value is immutable.
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.topology.x-kubernetes-validations[0].rule=self == oldSelf
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.default=PreferablyLocal
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.description=The Storage class's access mode. Might be:
- Local (in this mode the Storage class's 'allowRemoteVolumeAccess' param equals 'false'
and Volume Binding mode equals 'WaitForFirstConsumer')
- EventuallyLocal (in this mode the Storage class's 'allowRemoteVolumeAccess' param 
equals '- fromSame:\n  - topology.kubernetes.io/zone', 'auto-diskful' param equals '30' minutes, 
'auto-diskful-allow-cleanup' param equals 'true',
and Volume Binding mode equals 'WaitForFirstConsumer')
- PreferablyLocal (in this mode the Storage class's 'allowRemoteVolumeAccess' param 
equals '- fromSame:\n  - topology.kubernetes.io/zone',
and Volume Binding mode equals 'WaitForFirstConsumer')
- Any (in this mode the Storage class's 'allowRemoteVolumeAccess' param 
equals '- fromSame:\n  - topology.kubernetes.io/zone',
and Volume Binding mode equals 'Immediate')

> Note that the default Volume Access mode is 'PreferablyLocal'.

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.enum[0]=Local
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.enum[1]=EventuallyLocal
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.enum[2]=PreferablyLocal
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.enum[3]=Any
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.type=string
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.x-kubernetes-validations[0].message=Value is immutable.
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.volumeAccess.x-kubernetes-validations[0].rule=self == oldSelf
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.zones.description=Array of zones the Storage class's volumes should be replicated in. The controller will put a label with
the Storage class's name on the nodes which be actual used by the Storage class.

> Note that for Replication mode 'Availability' and 'ConsistencyAndAvailability' you have to select 
exactly 1 or 3 zones.

spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.zones.items.type=string
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.zones.type=array
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.zones.x-kubernetes-validations[0].message=Value is immutable.
spec.versions[0].schema.openAPIV3Schema.properties.spec.properties.zones.x-kubernetes-validations[0].rule=self == oldSelf
spec.versions[0].schema.openAPIV3Schema.properties.spec.required[0]=storagePool
spec.versions[0].schema.openAPIV3Schema.properties.spec.required[1]=reclaimPolicy
spec.versions[0].schema.openAPIV3Schema.properties.spec.required[2]=topology
spec.versions[0].schema.openAPIV3Schema.properties.spec.type=object
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[0].message=When "replication" is not set or is set to "Availability" or "ConsistencyAndAvailability" (default value), "zones" must be either not specified, or must contain exactly three zones.
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[0].rule=(has(self.replication) && self.replication == "None") || ((!has(self.replication) || self.replication == "Availability" || self.replication == "ConsistencyAndAvailability") && (!has(self.zones) || size(self.zones) == 0 || size(self.zones) == 1 || size(self.zones) == 3))
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[1].message=zones field cannot be deleted or added
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[1].rule=(has(self.zones) && has(oldSelf.zones)) || (!has(self.zones) && !has(oldSelf.zones))
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[2].message=replication filed cannot be deleted or added
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[2].rule=(has(self.replication) && has(oldSelf.replication)) || (!has(self.replication) && !has(oldSelf.replication))
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[3].message=volumeAccess filed cannot be deleted or added
spec.versions[0].schema.openAPIV3Schema.properties.spec.x-kubernetes-validations[3].rule=(has(self.volumeAccess) && has(oldSelf.volumeAccess)) || (!has(self.volumeAccess) && !has(oldSelf.volumeAccess))
spec.versions[0].schema.openAPIV3Schema.properties.status.description=Displays current information about the Storage Class.

spec.versions[0].schema.openAPIV3Schema.properties.status.properties.phase.description=The Storage class current state. Might be: 
- Failed (if the controller received incorrect resource configuration or some errors occurred during the operation)
- Create (if everything went fine)

spec.versions[0].schema.openAPIV3Schema.properties.status.properties.phase.enum[0]=Failed
spec.versions[0].schema.openAPIV3Schema.properties.status.properties.phase.enum[1]=Created
spec.versions[0].schema.openAPIV3Schema.properties.status.properties.phase.type=string
spec.versions[0].schema.openAPIV3Schema.properties.status.properties.reason.description=Additional information about the current state of the Storage Class.

spec.versions[0].schema.openAPIV3Schema.properties.status.properties.reason.type=string
spec.versions[0].schema.openAPIV3Schema.properties.status.type=object
spec.versions[0].schema.openAPIV3Schema.required[0]=spec
spec.versions[0].schema.openAPIV3Schema.type=object
spec.versions[0].served=true
spec.versions[0].storage=true
