---
image: {{ $.ImageName }}-artifact
from: {{ $.Root.BASE_ALPINE_DEV }}
final: false

git:
  - add: /
    to: /repo
    # excludePaths:
    # - werf.inc.yaml
    # includePaths:
    # - scripts/install
    # - scripts/uninstall
    # - tools/evict.sh
    # - tools/replicas_manager.sh

shell:
  setup:
    - mkdir /relocate
    - chmod a+x /repo/images/service-scripts/scripts/*
    - mv /repo/images/service-scripts/scripts/* /relocate/
    - chmod a+x /repo/images/service-scripts/tools/*
    - mv /repo/images/service-scripts/tools/* /relocate/
---
image: {{ $.ImageName }}
from: {{ $.Root.BASE_SCRATCH }}

import:
  - image: {{ $.ImageName }}-artifact
    add: /relocate/
    to: /
    before: setup
docker:
  LABEL:
    distro: all
    version: all
